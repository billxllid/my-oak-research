---
description: 仪表盘功能实现规范
globs:
  - "apps/web/app/(dashboard)/**"
alwaysApply: true
---

# Oak Research - 仪表盘功能规范

本规则基于 Figma 原型设计，定义 **仪表盘** 模块的页面布局、交互逻辑和组件使用方式。

## 1. 功能结构

仪表盘包含三个核心展示区：

1. **Top 5 关键词**
   - 展示关注度最高的前 5 个关键词
   - 显示关键词、数量、趋势（与昨日对比）
2. **趋势排行榜**
   - 图表（柱状图或折线图）展示关键词或平台趋势
   - 支持切换时间范围（如最近 7 天 / 30 天）
3. **最新消息列表**
   - 滚动列表展示最新获取的情报内容
   - 包含标题、摘要、时间、来源平台

## 2. 路由规范

```
apps/web/app/(dashboard)/
├── layout.tsx          # 子布局（继承全局 layout，保留左侧导航）
└── page.tsx            # 仪表盘首页

```

## 3. 页面布局规范

整体布局：

- 顶部：页面标题「仪表盘」+ 版本号（v1.0 - 日期）
- 主体：两行布局

第一行（关键词 Top5）：

- 使用 `grid grid-cols-5 gap-4`
- 卡片组件：`KeywordCard`
  - 内容：关键词名称、数量、趋势百分比（正负变化，箭头图标）

第二行：

- 左侧：趋势排行榜（使用 `ChartCard`）
- 右侧：最新消息列表（使用 `FocusCard` 的简化版）

## 4. 数据交互逻辑

关键词 Top5：

- API: `GET /api/dashboard/top-keywords`
- 返回结构：`[{ id, name, count, changePercent }]`
- 渲染为 `KeywordCard`

趋势排行榜：

- API: `GET /api/dashboard/trends?range=7d`
- 返回结构：`[{ keyword, values: [{ date, count }] }]`
- 使用 `recharts` 渲染 LineChart 或 BarChart

最新消息列表：

- API: `GET /api/dashboard/latest?limit=10`
- 返回结构：`[{ id, title, summary, platform, time }]`
- 渲染为列表卡片，点击可进入关注速报详情

所有数据通过 **SWR** 获取，并缓存结果。

## 5. UI 组件规范

- **KeywordCard**

  - 圆角卡片（Shadcn `<Card />`）
  - 显示关键词、数量、趋势箭头（`ArrowUpRight` 或 `ArrowDownRight`）
  - 数字加粗，趋势颜色：红色下降，绿色上升

- **ChartCard**

  - 内置标题栏（如「趋势排行榜」）
  - 使用 `recharts` 渲染图表，支持切换时间范围

- **LatestNewsList**
  - 垂直滚动列表，最多显示 10 条
  - 每条新闻：标题（加粗）、摘要（截断）、时间、来源平台标签
  - 点击跳转 `/focus-bulletin/[id]`

## 6. 响应式要求

- Top5 关键词在大屏显示 5 列，中屏 3 列，小屏 1–2 列
- 第二行在大屏 `grid-cols-2`，中屏自动换行
- 最新消息列表在小屏变为单列卡片列表

## 7. 开发约束

- Cursor 在生成仪表盘页面时，必须自动导入 `KeywordCard`、`ChartCard`、`LatestNewsList` 组件
- 所有图表必须基于 `recharts`，不允许使用其他图表库
- 趋势数据需支持模拟数据（开发阶段），上线时接入后端 API
- 最新消息列表必须重用 **关注速报卡片规范**，保证视觉一致性
